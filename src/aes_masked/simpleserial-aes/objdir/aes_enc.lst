   1               		.file	"aes_enc.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__CCP__ = 0x34
   7               	__tmp_reg__ = 0
   8               	__zero_reg__ = 1
   9               		.text
  10               	.Ltext0:
  11               		.cfi_sections	.debug_frame
  12               	.global	aes_shiftcol
  14               	aes_shiftcol:
  15               	.LFB1:
  16               		.file 1 ".././crypto/avrcryptolib//aes/aes_enc.c"
   1:.././crypto/avrcryptolib//aes/aes_enc.c **** /* aes_enc.c */
   2:.././crypto/avrcryptolib//aes/aes_enc.c **** /*
   3:.././crypto/avrcryptolib//aes/aes_enc.c ****     This file is part of the AVR-Crypto-Lib.
   4:.././crypto/avrcryptolib//aes/aes_enc.c ****     Copyright (C) 2008  Daniel Otte (daniel.otte@rub.de)
   5:.././crypto/avrcryptolib//aes/aes_enc.c **** 
   6:.././crypto/avrcryptolib//aes/aes_enc.c ****     This program is free software: you can redistribute it and/or modify
   7:.././crypto/avrcryptolib//aes/aes_enc.c ****     it under the terms of the GNU General Public License as published by
   8:.././crypto/avrcryptolib//aes/aes_enc.c ****     the Free Software Foundation, either version 3 of the License, or
   9:.././crypto/avrcryptolib//aes/aes_enc.c ****     (at your option) any later version.
  10:.././crypto/avrcryptolib//aes/aes_enc.c **** 
  11:.././crypto/avrcryptolib//aes/aes_enc.c ****     This program is distributed in the hope that it will be useful,
  12:.././crypto/avrcryptolib//aes/aes_enc.c ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:.././crypto/avrcryptolib//aes/aes_enc.c ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:.././crypto/avrcryptolib//aes/aes_enc.c ****     GNU General Public License for more details.
  15:.././crypto/avrcryptolib//aes/aes_enc.c **** 
  16:.././crypto/avrcryptolib//aes/aes_enc.c ****     You should have received a copy of the GNU General Public License
  17:.././crypto/avrcryptolib//aes/aes_enc.c ****     along with this program.  If not, see <http://www.gnu.org/licenses/>.
  18:.././crypto/avrcryptolib//aes/aes_enc.c **** */
  19:.././crypto/avrcryptolib//aes/aes_enc.c **** /**
  20:.././crypto/avrcryptolib//aes/aes_enc.c ****  * \file     aes_enc.c
  21:.././crypto/avrcryptolib//aes/aes_enc.c ****  * \email    daniel.otte@rub.de
  22:.././crypto/avrcryptolib//aes/aes_enc.c ****  * \author   Daniel Otte 
  23:.././crypto/avrcryptolib//aes/aes_enc.c ****  * \date     2008-12-30
  24:.././crypto/avrcryptolib//aes/aes_enc.c ****  * \license  GPLv3 or later
  25:.././crypto/avrcryptolib//aes/aes_enc.c ****  * 
  26:.././crypto/avrcryptolib//aes/aes_enc.c ****  */
  27:.././crypto/avrcryptolib//aes/aes_enc.c **** 
  28:.././crypto/avrcryptolib//aes/aes_enc.c **** #include <stdint.h>
  29:.././crypto/avrcryptolib//aes/aes_enc.c **** #include <string.h>
  30:.././crypto/avrcryptolib//aes/aes_enc.c **** #include "aes.h"
  31:.././crypto/avrcryptolib//aes/aes_enc.c **** #include "gf256mul.h"
  32:.././crypto/avrcryptolib//aes/aes_enc.c **** #include "aes_sbox.h"
  33:.././crypto/avrcryptolib//aes/aes_enc.c **** #include "aes_enc.h"
  34:.././crypto/avrcryptolib//aes/aes_enc.c **** #include <avr/pgmspace.h>
  35:.././crypto/avrcryptolib//aes/aes_enc.c **** #include "../../../simpleserial/simpleserial.h"
  36:.././crypto/avrcryptolib//aes/aes_enc.c **** 
  37:.././crypto/avrcryptolib//aes/aes_enc.c **** void aes_shiftcol(void* data, uint8_t shift){
  17               		.loc 1 37 0
  18               		.cfi_startproc
  19               	.LVL0:
  20 0000 CF93      		push r28
  21               	.LCFI0:
  22               		.cfi_def_cfa_offset 4
  23               		.cfi_offset 28, -3
  24 0002 DF93      		push r29
  25               	.LCFI1:
  26               		.cfi_def_cfa_offset 5
  27               		.cfi_offset 29, -4
  28 0004 00D0      		rcall .
  29 0006 1F92      		push __zero_reg__
  30               	.LCFI2:
  31               		.cfi_def_cfa_offset 9
  32 0008 CDB7      		in r28,__SP_L__
  33 000a DEB7      		in r29,__SP_H__
  34               	.LCFI3:
  35               		.cfi_def_cfa_register 28
  36               	/* prologue: function */
  37               	/* frame size = 4 */
  38               	/* stack size = 6 */
  39               	.L__stack_usage = 6
  40 000c DC01      		movw r26,r24
  38:.././crypto/avrcryptolib//aes/aes_enc.c **** 	uint8_t tmp[4];
  39:.././crypto/avrcryptolib//aes/aes_enc.c **** 	tmp[0] = ((uint8_t*)data)[ 0];
  41               		.loc 1 39 0
  42 000e 8C91      		ld r24,X
  43               	.LVL1:
  44 0010 8983      		std Y+1,r24
  40:.././crypto/avrcryptolib//aes/aes_enc.c **** 	tmp[1] = ((uint8_t*)data)[ 4];
  45               		.loc 1 40 0
  46 0012 1496      		adiw r26,4
  47 0014 8C91      		ld r24,X
  48 0016 1497      		sbiw r26,4
  49 0018 8A83      		std Y+2,r24
  41:.././crypto/avrcryptolib//aes/aes_enc.c **** 	tmp[2] = ((uint8_t*)data)[ 8];
  50               		.loc 1 41 0
  51 001a 1896      		adiw r26,8
  52 001c 8C91      		ld r24,X
  53 001e 1897      		sbiw r26,8
  54 0020 8B83      		std Y+3,r24
  42:.././crypto/avrcryptolib//aes/aes_enc.c **** 	tmp[3] = ((uint8_t*)data)[12];
  55               		.loc 1 42 0
  56 0022 1C96      		adiw r26,12
  57 0024 8C91      		ld r24,X
  58 0026 1C97      		sbiw r26,12
  59 0028 8C83      		std Y+4,r24
  43:.././crypto/avrcryptolib//aes/aes_enc.c **** 	((uint8_t*)data)[ 0] = tmp[(shift+0)&3];
  60               		.loc 1 43 0
  61 002a 862F      		mov r24,r22
  62 002c 8370      		andi r24,lo8(3)
  63 002e E1E0      		ldi r30,lo8(1)
  64 0030 F0E0      		ldi r31,0
  65 0032 EC0F      		add r30,r28
  66 0034 FD1F      		adc r31,r29
  67 0036 E80F      		add r30,r24
  68 0038 F11D      		adc r31,__zero_reg__
  69 003a 8081      		ld r24,Z
  70 003c 8C93      		st X,r24
  44:.././crypto/avrcryptolib//aes/aes_enc.c **** 	((uint8_t*)data)[ 4] = tmp[(shift+1)&3];
  71               		.loc 1 44 0
  72 003e 70E0      		ldi r23,0
  73 0040 FB01      		movw r30,r22
  74 0042 3196      		adiw r30,1
  75 0044 E370      		andi r30,3
  76 0046 FF27      		clr r31
  77 0048 81E0      		ldi r24,lo8(1)
  78 004a 90E0      		ldi r25,0
  79 004c 8C0F      		add r24,r28
  80 004e 9D1F      		adc r25,r29
  81 0050 E80F      		add r30,r24
  82 0052 F91F      		adc r31,r25
  83 0054 8081      		ld r24,Z
  84 0056 1496      		adiw r26,4
  85 0058 8C93      		st X,r24
  86 005a 1497      		sbiw r26,4
  45:.././crypto/avrcryptolib//aes/aes_enc.c **** 	((uint8_t*)data)[ 8] = tmp[(shift+2)&3];
  87               		.loc 1 45 0
  88 005c FB01      		movw r30,r22
  89 005e 3296      		adiw r30,2
  90 0060 E370      		andi r30,3
  91 0062 FF27      		clr r31
  92 0064 81E0      		ldi r24,lo8(1)
  93 0066 90E0      		ldi r25,0
  94 0068 8C0F      		add r24,r28
  95 006a 9D1F      		adc r25,r29
  96 006c E80F      		add r30,r24
  97 006e F91F      		adc r31,r25
  98 0070 8081      		ld r24,Z
  99 0072 1896      		adiw r26,8
 100 0074 8C93      		st X,r24
 101 0076 1897      		sbiw r26,8
  46:.././crypto/avrcryptolib//aes/aes_enc.c **** 	((uint8_t*)data)[12] = tmp[(shift+3)&3];
 102               		.loc 1 46 0
 103 0078 FB01      		movw r30,r22
 104 007a 3396      		adiw r30,3
 105 007c E370      		andi r30,3
 106 007e FF27      		clr r31
 107 0080 81E0      		ldi r24,lo8(1)
 108 0082 90E0      		ldi r25,0
 109 0084 8C0F      		add r24,r28
 110 0086 9D1F      		adc r25,r29
 111 0088 E80F      		add r30,r24
 112 008a F91F      		adc r31,r25
 113 008c 8081      		ld r24,Z
 114 008e 1C96      		adiw r26,12
 115 0090 8C93      		st X,r24
 116               	/* epilogue start */
  47:.././crypto/avrcryptolib//aes/aes_enc.c **** }
 117               		.loc 1 47 0
 118 0092 2496      		adiw r28,4
 119 0094 CDBF      		out __SP_L__,r28
 120 0096 DEBF      		out __SP_H__,r29
 121 0098 DF91      		pop r29
 122 009a CF91      		pop r28
 123 009c 0895      		ret
 124               		.cfi_endproc
 125               	.LFE1:
 127               	.global	aes_encrypt_core
 129               	aes_encrypt_core:
 130               	.LFB4:
  48:.././crypto/avrcryptolib//aes/aes_enc.c **** 
  49:.././crypto/avrcryptolib//aes/aes_enc.c **** #define GF256MUL_1(a) (a)
  50:.././crypto/avrcryptolib//aes/aes_enc.c **** #define GF256MUL_2(a) (gf256mul(2, (a), 0x1b))
  51:.././crypto/avrcryptolib//aes/aes_enc.c **** #define GF256MUL_3(a) (gf256mul(3, (a), 0x1b))
  52:.././crypto/avrcryptolib//aes/aes_enc.c **** 
  53:.././crypto/avrcryptolib//aes/aes_enc.c **** static
  54:.././crypto/avrcryptolib//aes/aes_enc.c **** void aes_enc_round(aes_cipher_state_t* state, const aes_roundkey_t* k,uint8_t * aes_sbox2,uint8_t *
  55:.././crypto/avrcryptolib//aes/aes_enc.c **** 	uint8_t mask = *rmask;
  56:.././crypto/avrcryptolib//aes/aes_enc.c ****     uint8_t tmp[16], t;
  57:.././crypto/avrcryptolib//aes/aes_enc.c **** 	uint8_t i;
  58:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* subBytes */
  59:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<16; ++i){
  60:.././crypto/avrcryptolib//aes/aes_enc.c ****         uint8_t help = state->s[i];
  61:.././crypto/avrcryptolib//aes/aes_enc.c **** 		tmp[i] = aes_sbox2[help];
  62:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
  63:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
  64:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* shiftRows */
  65:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(tmp+1, 1);
  66:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(tmp+2, 2);
  67:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(tmp+3, 3);
  68:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
  69:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<16; ++i){
  70:.././crypto/avrcryptolib//aes/aes_enc.c **** 		tmp[i] ^= mask;
  71:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
  72:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
  73:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* mixColums */
  74:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<4; ++i){ 
  75:.././crypto/avrcryptolib//aes/aes_enc.c **** 		t = tmp[4*i+0] ^ tmp[4*i+1] ^ tmp[4*i+2] ^ tmp[4*i+3];
  76:.././crypto/avrcryptolib//aes/aes_enc.c **** 		
  77:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[4*i+0] =
  78:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+0]^tmp[4*i+1])
  79:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+0]
  80:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ t
  81:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ mask;
  82:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[4*i+1] =
  83:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+1]^tmp[4*i+2])
  84:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+1]
  85:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ t
  86:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ mask;
  87:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[4*i+2] =
  88:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+2]^tmp[4*i+3])
  89:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+2]
  90:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ t
  91:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ mask;
  92:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[4*i+3] =
  93:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+3]^tmp[4*i+0])
  94:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+3]
  95:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ t
  96:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ mask;
  97:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
  98:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
  99:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* addKey */
 100:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<16; ++i){
 101:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= k->ks[i];
 102:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 103:.././crypto/avrcryptolib//aes/aes_enc.c **** }
 104:.././crypto/avrcryptolib//aes/aes_enc.c **** 
 105:.././crypto/avrcryptolib//aes/aes_enc.c **** 
 106:.././crypto/avrcryptolib//aes/aes_enc.c **** static
 107:.././crypto/avrcryptolib//aes/aes_enc.c **** void aes_enc_lastround(aes_cipher_state_t* state,const aes_roundkey_t* k,uint8_t * aes_sbox2){
 108:.././crypto/avrcryptolib//aes/aes_enc.c **** 	uint8_t i;
 109:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* subBytes */
 110:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<16; ++i){
 111:.././crypto/avrcryptolib//aes/aes_enc.c **** 		uint8_t help = state->s[i];
 112:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] = aes_sbox2[help];
 113:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 114:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* shiftRows */
 115:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(state->s+1, 1);
 116:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(state->s+2, 2);
 117:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(state->s+3, 3);
 118:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* keyAdd */
 119:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<16; ++i){
 120:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= k->ks[i];
 121:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 122:.././crypto/avrcryptolib//aes/aes_enc.c **** }
 123:.././crypto/avrcryptolib//aes/aes_enc.c **** 
 124:.././crypto/avrcryptolib//aes/aes_enc.c **** void aes_encrypt_core(aes_cipher_state_t* state, const aes_genctx_t* ks, uint8_t rounds,uint8_t * a
 131               		.loc 1 124 0
 132               		.cfi_startproc
 133               	.LVL2:
 134 009e 2F92      		push r2
 135               	.LCFI4:
 136               		.cfi_def_cfa_offset 4
 137               		.cfi_offset 2, -3
 138 00a0 3F92      		push r3
 139               	.LCFI5:
 140               		.cfi_def_cfa_offset 5
 141               		.cfi_offset 3, -4
 142 00a2 4F92      		push r4
 143               	.LCFI6:
 144               		.cfi_def_cfa_offset 6
 145               		.cfi_offset 4, -5
 146 00a4 5F92      		push r5
 147               	.LCFI7:
 148               		.cfi_def_cfa_offset 7
 149               		.cfi_offset 5, -6
 150 00a6 6F92      		push r6
 151               	.LCFI8:
 152               		.cfi_def_cfa_offset 8
 153               		.cfi_offset 6, -7
 154 00a8 7F92      		push r7
 155               	.LCFI9:
 156               		.cfi_def_cfa_offset 9
 157               		.cfi_offset 7, -8
 158 00aa 8F92      		push r8
 159               	.LCFI10:
 160               		.cfi_def_cfa_offset 10
 161               		.cfi_offset 8, -9
 162 00ac 9F92      		push r9
 163               	.LCFI11:
 164               		.cfi_def_cfa_offset 11
 165               		.cfi_offset 9, -10
 166 00ae AF92      		push r10
 167               	.LCFI12:
 168               		.cfi_def_cfa_offset 12
 169               		.cfi_offset 10, -11
 170 00b0 BF92      		push r11
 171               	.LCFI13:
 172               		.cfi_def_cfa_offset 13
 173               		.cfi_offset 11, -12
 174 00b2 CF92      		push r12
 175               	.LCFI14:
 176               		.cfi_def_cfa_offset 14
 177               		.cfi_offset 12, -13
 178 00b4 DF92      		push r13
 179               	.LCFI15:
 180               		.cfi_def_cfa_offset 15
 181               		.cfi_offset 13, -14
 182 00b6 EF92      		push r14
 183               	.LCFI16:
 184               		.cfi_def_cfa_offset 16
 185               		.cfi_offset 14, -15
 186 00b8 FF92      		push r15
 187               	.LCFI17:
 188               		.cfi_def_cfa_offset 17
 189               		.cfi_offset 15, -16
 190 00ba 0F93      		push r16
 191               	.LCFI18:
 192               		.cfi_def_cfa_offset 18
 193               		.cfi_offset 16, -17
 194 00bc 1F93      		push r17
 195               	.LCFI19:
 196               		.cfi_def_cfa_offset 19
 197               		.cfi_offset 17, -18
 198 00be CF93      		push r28
 199               	.LCFI20:
 200               		.cfi_def_cfa_offset 20
 201               		.cfi_offset 28, -19
 202 00c0 DF93      		push r29
 203               	.LCFI21:
 204               		.cfi_def_cfa_offset 21
 205               		.cfi_offset 29, -20
 206 00c2 CDB7      		in r28,__SP_L__
 207 00c4 DEB7      		in r29,__SP_H__
 208               	.LCFI22:
 209               		.cfi_def_cfa_register 28
 210 00c6 6897      		sbiw r28,24
 211               	.LCFI23:
 212               		.cfi_def_cfa_offset 45
 213 00c8 CDBF      		out __SP_L__,r28
 214 00ca DEBF      		out __SP_H__,r29
 215               	/* prologue: function */
 216               	/* frame size = 24 */
 217               	/* stack size = 42 */
 218               	.L__stack_usage = 42
 219 00cc 7C01      		movw r14,r24
 220 00ce 5B01      		movw r10,r22
 221 00d0 4C8B      		std Y+20,r20
 222 00d2 1901      		movw r2,r18
 223 00d4 0F8B      		std Y+23,r16
 224 00d6 188F      		std Y+24,r17
 225               	.LVL3:
 226 00d8 DB01      		movw r26,r22
 227 00da 8A8B      		std Y+18,r24
 228 00dc 9B8B      		std Y+19,r25
 229 00de 9C01      		movw r18,r24
 230               	.LVL4:
 231 00e0 205F      		subi r18,-16
 232 00e2 3F4F      		sbci r19,-1
 233 00e4 2D8B      		std Y+21,r18
 234 00e6 3E8B      		std Y+22,r19
 235               		.loc 1 124 0
 236 00e8 FC01      		movw r30,r24
 237               	.LVL5:
 238               	.L3:
 125:.././crypto/avrcryptolib//aes/aes_enc.c ****     uint8_t i;
 126:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(i=0; i<16; ++i){
 127:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= ks->key[0].ks[i];
 239               		.loc 1 127 0 discriminator 3
 240 00ea 8D91      		ld r24,X+
 241 00ec 9081      		ld r25,Z
 242 00ee 8927      		eor r24,r25
 243 00f0 8193      		st Z+,r24
 244               	.LVL6:
 126:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= ks->key[0].ks[i];
 245               		.loc 1 126 0 discriminator 3
 246 00f2 8D89      		ldd r24,Y+21
 247 00f4 9E89      		ldd r25,Y+22
 248 00f6 E817      		cp r30,r24
 249 00f8 F907      		cpc r31,r25
 250 00fa 01F4      		brne .L3
 251 00fc 3501      		movw r6,r10
 252 00fe 90E1      		ldi r25,16
 253 0100 690E      		add r6,r25
 254 0102 711C      		adc r7,__zero_reg__
 126:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= ks->key[0].ks[i];
 255               		.loc 1 126 0 is_stmt 0
 256 0104 A1E0      		ldi r26,lo8(1)
 257 0106 A98B      		std Y+17,r26
 258 0108 4E01      		movw r8,r28
 259 010a B1E1      		ldi r27,17
 260 010c 8B0E      		add r8,r27
 261 010e 911C      		adc r9,__zero_reg__
 262               	.LVL7:
 263               	.L4:
 128:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 129:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
 130:.././crypto/avrcryptolib//aes/aes_enc.c **** 	i=1;
 131:.././crypto/avrcryptolib//aes/aes_enc.c **** 	for(;rounds>1;--rounds){
 264               		.loc 1 131 0 is_stmt 1 discriminator 1
 265 0110 9C89      		ldd r25,Y+20
 266 0112 9230      		cpi r25,lo8(2)
 267 0114 00F4      		brsh .+2
 268 0116 00C0      		rjmp .L20
 269 0118 EF89      		ldd r30,Y+23
 270 011a F88D      		ldd r31,Y+24
 271 011c 4080      		ld r4,Z
 272               	.LVL8:
 273 011e 8E01      		movw r16,r28
 274 0120 0F5F      		subi r16,-1
 275 0122 1F4F      		sbci r17,-1
 276               		.loc 1 131 0 is_stmt 0 discriminator 2
 277 0124 F801      		movw r30,r16
 278               	.LVL9:
 279 0126 A701      		movw r20,r14
 280               	.LVL10:
 281               	.L5:
 282               	.LBB9:
 283               	.LBB10:
 284               	.LBB11:
  60:.././crypto/avrcryptolib//aes/aes_enc.c **** 		tmp[i] = aes_sbox2[help];
 285               		.loc 1 60 0 is_stmt 1
 286 0128 DA01      		movw r26,r20
 287 012a 8D91      		ld r24,X+
 288 012c AD01      		movw r20,r26
 289               	.LVL11:
  61:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 290               		.loc 1 61 0
 291 012e 9101      		movw r18,r2
 292 0130 280F      		add r18,r24
 293 0132 311D      		adc r19,__zero_reg__
 294 0134 D901      		movw r26,r18
 295 0136 8C91      		ld r24,X
 296               	.LVL12:
 297 0138 8193      		st Z+,r24
 298               	.LVL13:
 299               	.LBE11:
  59:.././crypto/avrcryptolib//aes/aes_enc.c ****         uint8_t help = state->s[i];
 300               		.loc 1 59 0
 301 013a E815      		cp r30,r8
 302 013c F905      		cpc r31,r9
 303 013e 01F4      		brne .L5
  65:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(tmp+2, 2);
 304               		.loc 1 65 0
 305 0140 61E0      		ldi r22,lo8(1)
 306 0142 CE01      		movw r24,r28
 307 0144 0296      		adiw r24,2
 308 0146 0E94 0000 		call aes_shiftcol
 309               	.LVL14:
  66:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(tmp+3, 3);
 310               		.loc 1 66 0
 311 014a 62E0      		ldi r22,lo8(2)
 312 014c CE01      		movw r24,r28
 313 014e 0396      		adiw r24,3
 314 0150 0E94 0000 		call aes_shiftcol
 315               	.LVL15:
  67:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
 316               		.loc 1 67 0
 317 0154 63E0      		ldi r22,lo8(3)
 318 0156 CE01      		movw r24,r28
 319 0158 0496      		adiw r24,4
 320 015a 0E94 0000 		call aes_shiftcol
 321               	.LVL16:
 322 015e F801      		movw r30,r16
 323               	.LVL17:
 324               	.L6:
  70:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 325               		.loc 1 70 0
 326 0160 8081      		ld r24,Z
 327 0162 8425      		eor r24,r4
 328 0164 8193      		st Z+,r24
  69:.././crypto/avrcryptolib//aes/aes_enc.c **** 		tmp[i] ^= mask;
 329               		.loc 1 69 0
 330 0166 E815      		cp r30,r8
 331 0168 F905      		cpc r31,r9
 332 016a 01F4      		brne .L6
 333 016c 6701      		movw r12,r14
 334               	.L7:
  75:.././crypto/avrcryptolib//aes/aes_enc.c **** 		
 335               		.loc 1 75 0
 336 016e F801      		movw r30,r16
 337 0170 6081      		ld r22,Z
 338 0172 8181      		ldd r24,Z+1
 339 0174 6827      		eor r22,r24
 340 0176 9281      		ldd r25,Z+2
 341 0178 8381      		ldd r24,Z+3
 342 017a 8927      		eor r24,r25
 343 017c 582E      		mov r5,r24
 344 017e 5626      		eor r5,r22
 345               	.LVL18:
  78:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+0]
 346               		.loc 1 78 0
 347 0180 4BE1      		ldi r20,lo8(27)
 348 0182 82E0      		ldi r24,lo8(2)
 349 0184 0E94 0000 		call gf256mul
 350               	.LVL19:
  77:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+0]^tmp[4*i+1])
 351               		.loc 1 77 0
 352 0188 8425      		eor r24,r4
 353 018a D801      		movw r26,r16
 354 018c 9C91      		ld r25,X
 355 018e 8927      		eor r24,r25
 356 0190 8525      		eor r24,r5
 357 0192 F601      		movw r30,r12
 358 0194 8083      		st Z,r24
  83:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+1]
 359               		.loc 1 83 0
 360 0196 1196      		adiw r26,1
 361 0198 6C91      		ld r22,X
 362 019a 1197      		sbiw r26,1
 363 019c 1296      		adiw r26,2
 364 019e 8C91      		ld r24,X
 365 01a0 6827      		eor r22,r24
 366 01a2 4BE1      		ldi r20,lo8(27)
 367 01a4 82E0      		ldi r24,lo8(2)
 368 01a6 0E94 0000 		call gf256mul
 369               	.LVL20:
  82:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+1]^tmp[4*i+2])
 370               		.loc 1 82 0
 371 01aa 8425      		eor r24,r4
 372 01ac D801      		movw r26,r16
 373 01ae 1196      		adiw r26,1
 374 01b0 9C91      		ld r25,X
 375 01b2 1197      		sbiw r26,1
 376 01b4 8927      		eor r24,r25
 377 01b6 8525      		eor r24,r5
 378 01b8 F601      		movw r30,r12
 379 01ba 8183      		std Z+1,r24
  88:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+2]
 380               		.loc 1 88 0
 381 01bc 1296      		adiw r26,2
 382 01be 6C91      		ld r22,X
 383 01c0 1297      		sbiw r26,2
 384 01c2 1396      		adiw r26,3
 385 01c4 8C91      		ld r24,X
 386 01c6 6827      		eor r22,r24
 387 01c8 4BE1      		ldi r20,lo8(27)
 388 01ca 82E0      		ldi r24,lo8(2)
 389 01cc 0E94 0000 		call gf256mul
 390               	.LVL21:
  87:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+2]^tmp[4*i+3])
 391               		.loc 1 87 0
 392 01d0 8425      		eor r24,r4
 393 01d2 D801      		movw r26,r16
 394 01d4 1296      		adiw r26,2
 395 01d6 9C91      		ld r25,X
 396 01d8 1297      		sbiw r26,2
 397 01da 8927      		eor r24,r25
 398 01dc 8525      		eor r24,r5
 399 01de F601      		movw r30,r12
 400 01e0 8283      		std Z+2,r24
  93:.././crypto/avrcryptolib//aes/aes_enc.c **** 			^ tmp[4*i+3]
 401               		.loc 1 93 0
 402 01e2 1396      		adiw r26,3
 403 01e4 6C91      		ld r22,X
 404 01e6 1397      		sbiw r26,3
 405 01e8 8C91      		ld r24,X
 406 01ea 6827      		eor r22,r24
 407 01ec 4BE1      		ldi r20,lo8(27)
 408 01ee 82E0      		ldi r24,lo8(2)
 409 01f0 0E94 0000 		call gf256mul
 410               	.LVL22:
  92:.././crypto/avrcryptolib//aes/aes_enc.c **** 			  GF256MUL_2(tmp[4*i+3]^tmp[4*i+0])
 411               		.loc 1 92 0
 412 01f4 8425      		eor r24,r4
 413 01f6 D801      		movw r26,r16
 414 01f8 1396      		adiw r26,3
 415 01fa 9C91      		ld r25,X
 416 01fc 8927      		eor r24,r25
 417 01fe 8525      		eor r24,r5
 418 0200 F601      		movw r30,r12
 419 0202 8383      		std Z+3,r24
 420 0204 0C5F      		subi r16,-4
 421 0206 1F4F      		sbci r17,-1
 422 0208 F4E0      		ldi r31,4
 423 020a CF0E      		add r12,r31
 424 020c D11C      		adc r13,__zero_reg__
  74:.././crypto/avrcryptolib//aes/aes_enc.c **** 		t = tmp[4*i+0] ^ tmp[4*i+1] ^ tmp[4*i+2] ^ tmp[4*i+3];
 425               		.loc 1 74 0
 426 020e 0815      		cp r16,r8
 427 0210 1905      		cpc r17,r9
 428 0212 01F0      		breq .+2
 429 0214 00C0      		rjmp .L7
 430 0216 F701      		movw r30,r14
 431 0218 80E0      		ldi r24,0
 432 021a 90E0      		ldi r25,0
 433               	.L8:
 434               	.LVL23:
 101:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 435               		.loc 1 101 0
 436 021c D301      		movw r26,r6
 437 021e A80F      		add r26,r24
 438 0220 B91F      		adc r27,r25
 439 0222 3081      		ld r19,Z
 440 0224 2C91      		ld r18,X
 441 0226 2327      		eor r18,r19
 442 0228 2193      		st Z+,r18
 443               	.LVL24:
 444 022a 0196      		adiw r24,1
 445               	.LVL25:
 100:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= k->ks[i];
 446               		.loc 1 100 0
 447 022c 8031      		cpi r24,16
 448 022e 9105      		cpc r25,__zero_reg__
 449 0230 01F4      		brne .L8
 450               	.LVL26:
 451               	.LBE10:
 452               	.LBE9:
 132:.././crypto/avrcryptolib//aes/aes_enc.c **** 		aes_enc_round(state, &(ks->key[i]),aes_sbox2,rmask);
 133:.././crypto/avrcryptolib//aes/aes_enc.c **** 		++i;
 453               		.loc 1 133 0
 454 0232 2989      		ldd r18,Y+17
 455 0234 2F5F      		subi r18,lo8(-(1))
 456 0236 298B      		std Y+17,r18
 457               	.LVL27:
 131:.././crypto/avrcryptolib//aes/aes_enc.c **** 		aes_enc_round(state, &(ks->key[i]),aes_sbox2,rmask);
 458               		.loc 1 131 0
 459 0238 3C89      		ldd r19,Y+20
 460 023a 3150      		subi r19,lo8(-(-1))
 461 023c 3C8B      		std Y+20,r19
 462               	.LVL28:
 463 023e 80E1      		ldi r24,16
 464 0240 680E      		add r6,r24
 465 0242 711C      		adc r7,__zero_reg__
 466 0244 00C0      		rjmp .L4
 467               	.LVL29:
 468               	.L20:
 134:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 135:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
 136:.././crypto/avrcryptolib//aes/aes_enc.c **** 	
 137:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_enc_lastround(state, &(ks->key[i]),aes_sbox2);
 469               		.loc 1 137 0
 470 0246 F701      		movw r30,r14
 471               	.LVL30:
 472               	.L10:
 473               	.LBB12:
 474               	.LBB13:
 475               	.LBB14:
 112:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 476               		.loc 1 112 0
 477 0248 8081      		ld r24,Z
 478 024a D101      		movw r26,r2
 479 024c A80F      		add r26,r24
 480 024e B11D      		adc r27,__zero_reg__
 481 0250 8C91      		ld r24,X
 482 0252 8193      		st Z+,r24
 483               	.LVL31:
 484               	.LBE14:
 110:.././crypto/avrcryptolib//aes/aes_enc.c **** 		uint8_t help = state->s[i];
 485               		.loc 1 110 0
 486 0254 AD89      		ldd r26,Y+21
 487 0256 BE89      		ldd r27,Y+22
 488 0258 EA17      		cp r30,r26
 489 025a FB07      		cpc r31,r27
 490 025c 01F4      		brne .L10
 115:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(state->s+2, 2);
 491               		.loc 1 115 0
 492 025e 61E0      		ldi r22,lo8(1)
 493 0260 C701      		movw r24,r14
 494 0262 0196      		adiw r24,1
 495 0264 0E94 0000 		call aes_shiftcol
 496               	.LVL32:
 116:.././crypto/avrcryptolib//aes/aes_enc.c **** 	aes_shiftcol(state->s+3, 3);
 497               		.loc 1 116 0
 498 0268 62E0      		ldi r22,lo8(2)
 499 026a C701      		movw r24,r14
 500 026c 0296      		adiw r24,2
 501 026e 0E94 0000 		call aes_shiftcol
 502               	.LVL33:
 117:.././crypto/avrcryptolib//aes/aes_enc.c **** 	/* keyAdd */
 503               		.loc 1 117 0
 504 0272 63E0      		ldi r22,lo8(3)
 505 0274 C701      		movw r24,r14
 506 0276 0396      		adiw r24,3
 507 0278 0E94 0000 		call aes_shiftcol
 508               	.LVL34:
 509 027c E989      		ldd r30,Y+17
 510 027e B0E1      		ldi r27,lo8(16)
 511 0280 EB9F      		mul r30,r27
 512 0282 C001      		movw r24,r0
 513 0284 1124      		clr __zero_reg__
 514 0286 20E0      		ldi r18,0
 515 0288 30E0      		ldi r19,0
 516               	.LVL35:
 517               	.L11:
 120:.././crypto/avrcryptolib//aes/aes_enc.c **** 	}
 518               		.loc 1 120 0
 519 028a FC01      		movw r30,r24
 520 028c E20F      		add r30,r18
 521 028e F31F      		adc r31,r19
 522 0290 EA0D      		add r30,r10
 523 0292 FB1D      		adc r31,r11
 524 0294 AA89      		ldd r26,Y+18
 525 0296 BB89      		ldd r27,Y+19
 526 0298 5C91      		ld r21,X
 527 029a 4081      		ld r20,Z
 528 029c 4527      		eor r20,r21
 529 029e 4D93      		st X+,r20
 530 02a0 AA8B      		std Y+18,r26
 531 02a2 BB8B      		std Y+19,r27
 532               	.LVL36:
 533 02a4 2F5F      		subi r18,-1
 534 02a6 3F4F      		sbci r19,-1
 535               	.LVL37:
 119:.././crypto/avrcryptolib//aes/aes_enc.c **** 		state->s[i] ^= k->ks[i];
 536               		.loc 1 119 0
 537 02a8 2031      		cpi r18,16
 538 02aa 3105      		cpc r19,__zero_reg__
 539 02ac 01F4      		brne .L11
 540               	/* epilogue start */
 541               	.LBE13:
 542               	.LBE12:
 138:.././crypto/avrcryptolib//aes/aes_enc.c **** }
 543               		.loc 1 138 0
 544 02ae 6896      		adiw r28,24
 545 02b0 CDBF      		out __SP_L__,r28
 546 02b2 DEBF      		out __SP_H__,r29
 547 02b4 DF91      		pop r29
 548 02b6 CF91      		pop r28
 549 02b8 1F91      		pop r17
 550 02ba 0F91      		pop r16
 551 02bc FF90      		pop r15
 552 02be EF90      		pop r14
 553               	.LVL38:
 554 02c0 DF90      		pop r13
 555 02c2 CF90      		pop r12
 556 02c4 BF90      		pop r11
 557 02c6 AF90      		pop r10
 558               	.LVL39:
 559 02c8 9F90      		pop r9
 560 02ca 8F90      		pop r8
 561 02cc 7F90      		pop r7
 562 02ce 6F90      		pop r6
 563 02d0 5F90      		pop r5
 564 02d2 4F90      		pop r4
 565 02d4 3F90      		pop r3
 566 02d6 2F90      		pop r2
 567               	.LVL40:
 568 02d8 0895      		ret
 569               		.cfi_endproc
 570               	.LFE4:
 572               	.Letext0:
 573               		.file 2 "/usr/lib/avr/include/stdint.h"
 574               		.file 3 ".././crypto/avrcryptolib//aes/aes_types.h"
 575               		.file 4 ".././crypto/avrcryptolib//gf256mul/gf256mul.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 aes_enc.c
     /tmp/ccHe8wNp.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccHe8wNp.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccHe8wNp.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccHe8wNp.s:5      *ABS*:000000000000003b __RAMPZ__
     /tmp/ccHe8wNp.s:6      *ABS*:0000000000000034 __CCP__
     /tmp/ccHe8wNp.s:7      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccHe8wNp.s:8      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccHe8wNp.s:14     .text:0000000000000000 aes_shiftcol
     /tmp/ccHe8wNp.s:129    .text:000000000000009e aes_encrypt_core

UNDEFINED SYMBOLS
gf256mul
